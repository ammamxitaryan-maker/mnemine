# üéØ –°–∏—Å—Ç–µ–º–∞ —Å—Ç—Ä–æ–≥–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–∏

## –û–±–∑–æ—Ä

–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –∑–∞–º–µ–Ω—è–µ—Ç –≤—Å–µ `any` —Ç–∏–ø—ã –Ω–∞ —Å—Ç—Ä–æ–≥–∏–µ TypeScript —Ç–∏–ø—ã, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –ª—É—á—à—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É IDE –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### ‚úÖ **–î–æ (–ø—Ä–æ–±–ª–µ–º—ã):**
- 187+ —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `any` —Ç–∏–ø–æ–≤
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –°–ª–æ–∂–Ω–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏
- –ù–µ—Ç –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –≤ IDE
- Runtime –æ—à–∏–±–∫–∏ –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤

### ‚úÖ **–ü–æ—Å–ª–µ (—Ä–µ—à–µ–Ω–∏—è):**
- –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö API –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- Runtime –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å Zod
- –ü–æ–ª–Ω–∞—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –û—Ç–ª–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ IDE
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **API Types** (`server/src/types/api.ts`)
   - –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
   - –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

2. **Business Types** (`server/src/types/business.ts`)
   - –í—Å–µ –±–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç–∏ (User, Slot, Transaction, etc.)
   - –°—Ç—Ä–æ–≥–∏–µ —Ç–∏–ø—ã –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Prisma —Å—Ö–µ–º–æ–π

3. **WebSocket Types** (`server/src/types/websocket.ts`)
   - –¢–∏–ø—ã –¥–ª—è real-time –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
   - –°–æ–±—ã—Ç–∏—è –∏ —Å–æ–æ–±—â–µ–Ω–∏—è
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏

4. **Validation Schemas** (`server/src/validation/schemas.ts`)
   - Zod —Å—Ö–µ–º—ã –¥–ª—è runtime –≤–∞–ª–∏–¥–∞—Ü–∏–∏
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö API endpoints
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∏–ø–æ–≤

5. **Client Types** (`client/src/types/api.ts`)
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
   - –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã

## üìã –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã:

```typescript
import { 
  ApiResponse, 
  UserProfile, 
  MiningSlotInfo, 
  TransactionInfo 
} from '../types/business.js';

// –°—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
async function getUserProfile(userId: string): Promise<ApiResponse<UserProfile>> {
  // TypeScript –∑–Ω–∞–µ—Ç —Ç–æ—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–∞
}

async function purchaseSlot(
  request: SlotPurchaseRequest
): Promise<ApiResponse<SlotPurchaseResponse>> {
  // –í—Å–µ –ø–æ–ª—è —Å—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
}
```

### Runtime –≤–∞–ª–∏–¥–∞—Ü–∏—è:

```typescript
import { validateRequest } from '../middleware/validation.js';
import { SlotPurchaseSchema } from '../validation/schemas.js';

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞
router.post('/slots/purchase', 
  validateRequest(SlotPurchaseSchema),
  async (req: Request, res: Response) => {
    // req.validatedData —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    const { amount, currency, type } = getValidatedData<SlotPurchaseInput>(req);
    
    // TypeScript –∑–Ω–∞–µ—Ç —Ç–æ—á–Ω—ã–µ —Ç–∏–ø—ã
  }
);
```

### –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã:

```typescript
import { 
  ControllerRequest, 
  ControllerResponse,
  getValidatedData 
} from '../types/index.js';

export const purchaseSlot = async (
  req: ControllerRequest,
  res: ControllerResponse
): Promise<void> => {
  // req.user —Å—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω
  const userId = req.user.id;
  
  // –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  const slotData = getValidatedData<SlotPurchaseInput>(req);
  
  // –°—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
  const result = await slotService.purchase(userId, slotData);
  
  res.json(createSuccessResponse(result));
};
```

## üéõÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤:

```typescript
import { Schemas } from '../validation/schemas.js';

// –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
router.post('/users', 
  validateRequest(Schemas.UserUpdate),
  createUser
);

// –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
router.get('/transactions',
  validateMultiple([
    { schema: Schemas.Pagination, source: 'query' },
    { schema: Schemas.DateRange, source: 'query' },
    { schema: Schemas.TransactionFilter, source: 'query' }
  ]),
  getTransactions
);
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤:

```typescript
import { UserProfileSchema } from '../validation/schemas.js';

// –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
router.get('/users/:id',
  validateRequest(Schemas.UserId, 'params'),
  validateResponse(UserProfileSchema),
  getUser
);
```

## üìä –¢–∏–ø—ã –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

### API Types:

| –¢–∏–ø | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä—ã |
|-----|------------|---------|
| `ApiResponse<T>` | –ë–∞–∑–æ–≤—ã–π –æ—Ç–≤–µ—Ç API | `ApiResponse<UserProfile>` |
| `PaginatedResponse<T>` | –ü–∞–≥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | `PaginatedResponse<TransactionInfo>` |
| `PaginationParams` | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ | `{ page: 1, limit: 20 }` |
| `DateRangeParams` | –§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–∞–º | `{ startDate: '2024-01-01' }` |

### Business Types:

| –¢–∏–ø | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä—ã |
|-----|------------|---------|
| `UserProfile` | –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ |
| `MiningSlotInfo` | –ú–∞–π–Ω–∏–Ω–≥ —Å–ª–æ—Ç | –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–ª–æ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `TransactionInfo` | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è | –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–ª–∞–Ω—Å–æ–º |
| `WalletInfo` | –ö–æ—à–µ–ª–µ–∫ | –ë–∞–ª–∞–Ω—Å –ø–æ –≤–∞–ª—é—Ç–∞–º |
| `LotteryInfo` | –õ–æ—Ç–µ—Ä–µ—è | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–æ–∑—ã–≥—Ä—ã—à–∞—Ö |

### WebSocket Types:

| –¢–∏–ø | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä—ã |
|-----|------------|---------|
| `WebSocketMessage<T>` | –°–æ–æ–±—â–µ–Ω–∏–µ WebSocket | `WebSocketMessage<EarningsUpdateEvent>` |
| `EarningsUpdateEvent` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤ | Real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |
| `BalanceUpdateEvent` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ | –ò–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ |
| `NotificationEvent` | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ | –°–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |

## üîß –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

### –°–∫—Ä–∏–ø—Ç –∑–∞–º–µ–Ω—ã any —Ç–∏–ø–æ–≤:

```bash
# –ê–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è any —Ç–∏–ø–æ–≤
node scripts/replace-any-types.js . analyze

# –ó–∞–º–µ–Ω–∞ any —Ç–∏–ø–æ–≤
node scripts/replace-any-types.js . replace
```

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:

1. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ `any` —Ç–∏–ø–æ–≤
2. **–ó–∞–º–µ–Ω—è–µ—Ç** `any` –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã
3. **–î–æ–±–∞–≤–ª—è–µ—Ç –∏–º–ø–æ—Ä—Ç—ã** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç** –ø–æ–¥—Ö–æ–¥—è—â–∏–µ —Ç–∏–ø—ã
5. **–ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç** —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã

## üìà –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Zod —Å—Ö–µ–º—ã:

```typescript
// –°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
export const SlotPurchaseSchema = z.object({
  amount: z.number().positive().max(1000000),
  currency: z.enum(['USD', 'MNE']),
  type: z.enum(['standard', 'premium', 'vip']).default('standard'),
}).refine(
  (data) => {
    if (data.currency === 'USD' && data.amount < 1) return false;
    if (data.currency === 'MNE' && data.amount < 10) return false;
    return true;
  },
  {
    message: "Minimum purchase amount: $1 USD or 10 MNE",
    path: ["amount"],
  }
);
```

### Middleware –≤–∞–ª–∏–¥–∞—Ü–∏–∏:

```typescript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è
app.use(sanitizeInput);
app.use(validateContentType(['application/json']));
app.use(validateRateLimit);
```

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –≠—Ç–∞–ø 2: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω
- [x] –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ runtime –≤–∞–ª–∏–¥–∞—Ü–∏—è
- [x] –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- [x] –û–±–Ω–æ–≤–ª–µ–Ω—ã –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Ç–∏–ø—ã

### –≠—Ç–∞–ø 3: üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∑–∞–º–µ–Ω—ã any —Ç–∏–ø–æ–≤
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –≠—Ç–∞–ø 4: üìã –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prisma
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∏–ø–æ–≤
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- [ ] Type-safe API –∫–ª–∏–µ–Ω—Ç

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–æ–≥–∏–µ —Ç–∏–ø—ã** - –∏–∑–±–µ–≥–∞–π—Ç–µ `any` –∏ `unknown`
2. **–í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Zod —Å—Ö–µ–º—ã
3. **–¢–∏–ø–∏–∑–∏—Ä—É–π—Ç–µ API** - –≤—Å–µ endpoints –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—Ç–∏–ª–∏—Ç—ã** - `Optional<T, K>`, `RequiredFields<T, K>`

### –î–ª—è production:

1. **–í–∫–ª—é—á–∏—Ç–µ —Å—Ç—Ä–æ–≥—É—é –ø—Ä–æ–≤–µ—Ä–∫—É** - `"strict": true` –≤ tsconfig
2. **–í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –≤—Å–µ –≤—Ö–æ–¥—ã** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ middleware –≤–∞–ª–∏–¥–∞—Ü–∏–∏
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ validation errors
4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ç–∏–ø—ã** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ type tests

## üîç –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ:

```typescript
import { 
  validateRequest, 
  getValidatedData,
  createSuccessResponse 
} from '../middleware/validation.js';
import { SlotPurchaseSchema, SlotPurchaseInput } from '../validation/schemas.js';

export const purchaseSlot = async (
  req: ControllerRequest,
  res: ControllerResponse
): Promise<void> => {
  try {
    // –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    const slotData = getValidatedData<SlotPurchaseInput>(req);
    const userId = req.user.id;
    
    // –°—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å
    const result = await slotService.purchase(userId, slotData);
    
    // –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
    res.json(createSuccessResponse(result, 'Slot purchased successfully'));
  } catch (error) {
    logger.error(LogContext.BUSINESS, 'Slot purchase failed', error, {
      userId: req.user.id,
      slotData: getValidatedData<SlotPurchaseInput>(req)
    });
    
    res.status(500).json(createErrorResponse('Purchase failed'));
  }
};
```

### –í —Å–µ—Ä–≤–∏—Å–µ:

```typescript
import { 
  UserProfile, 
  MiningSlotInfo, 
  SlotPurchaseRequest,
  SlotPurchaseResponse 
} from '../types/business.js';

export class SlotService {
  async purchase(
    userId: string, 
    request: SlotPurchaseRequest
  ): Promise<SlotPurchaseResponse> {
    // –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
    const user = await this.getUser(userId);
    const slot = await this.createSlot(userId, request);
    const transaction = await this.createTransaction(userId, request);
    
    return {
      slot,
      transaction,
      newBalance: user.wallets.find(w => w.currency === request.currency)?.balance || 0
    };
  }
}
```

### –í –∫–ª–∏–µ–Ω—Ç–µ:

```typescript
import { 
  ApiResponse, 
  UserProfile, 
  MiningSlotInfo,
  SlotPurchaseRequest 
} from '../types/api.js';

export const useSlotPurchase = () => {
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  
  const purchaseSlot = async (request: SlotPurchaseRequest): Promise<ApiResponse<MiningSlotInfo> | null> => {
    setIsLoading(true);
    setError(null);
    
    try {
      const response = await api.post<ApiResponse<MiningSlotInfo>>('/slots/purchase', request);
      return response.data;
    } catch (err) {
      setError(getErrorMessage(err));
      return null;
    } finally {
      setIsLoading(false);
    }
  };
  
  return { purchaseSlot, isLoading, error };
};
```

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–∞—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –æ—à–∏–±–æ–∫, –æ—Ç–ª–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ IDE –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥! üéâ
