# üìä –°–∏—Å—Ç–µ–º–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## –û–±–∑–æ—Ä

–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–º–µ–Ω—è–µ—Ç —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–µ `console.log` –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º–∏, —É—Ä–æ–≤–Ω—è–º–∏ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏.

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### ‚úÖ **–î–æ (–ø—Ä–æ–±–ª–µ–º—ã):**
- 1280+ —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã—Ö `console.log`
- –ù–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –°–ª–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞–¥–∞–µ—Ç –≤ production
- –ù–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### ‚úÖ **–ü–æ—Å–ª–µ (—Ä–µ—à–µ–Ω–∏—è):**
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –∏ —É—Ä–æ–≤–Ω–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –õ–µ–≥–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **Logger** (`server/src/utils/logger.ts`)
   - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
   - –£—Ä–æ–≤–Ω–∏: DEBUG, INFO, WARN, ERROR
   - –ö–æ–Ω—Ç–µ–∫—Å—Ç—ã: SERVER, DATABASE, WEBSOCKET, API, AUTH, TELEGRAM, PERFORMANCE, SECURITY, BUSINESS

2. **Request Logger** (`server/src/middleware/requestLogger.ts`)
   - Middleware –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
   - –¢—Ä–µ–∫–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ ID –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏

3. **Console Replacer** (`server/src/utils/consoleReplacer.ts`)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–º–µ–Ω–∞ `console.log` –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–∑ stack trace

## üìã –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```typescript
import { logger, LogContext } from './utils/logger.js';

// –ü—Ä–æ—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
logger.info(LogContext.SERVER, 'Server started successfully');

// –° –¥–∞–Ω–Ω—ã–º–∏
logger.business('Slot purchased', {
  userId: 'user123',
  amount: 100,
  currency: 'USD'
});

// –û—à–∏–±–∫–∏
logger.error(LogContext.DATABASE, 'Database connection failed', error);
```

### –£–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

```typescript
// –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã
logger.server('Server message');
logger.database('Database operation');
logger.websocket('WebSocket event');
logger.api('API request');
logger.auth('Authentication event');
logger.telegram('Telegram bot event');
logger.performance('Performance metric');
logger.security('Security event');
logger.business('Business operation');
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

```typescript
import { PerformanceTimer } from './utils/logger.js';

const timer = new PerformanceTimer(LogContext.API, 'Database query');
// ... –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
timer.end({ queryType: 'SELECT', rows: 100 });
```

## üéõÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

```typescript
import { LogLevel } from './utils/logger.js';

// –í development - –≤—Å–µ –ª–æ–≥–∏
logger.setLevel(LogLevel.DEBUG);

// –í production - —Ç–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã–µ
logger.setLevel(LogLevel.INFO);
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# –í–∫–ª—é—á–∏—Ç—å –∑–∞–º–µ–Ω—É console.log
ENABLE_CONSOLE_REPLACEMENT=true

# –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
LOG_LEVEL=INFO
```

## üìä –ö–æ–Ω—Ç–µ–∫—Å—Ç—ã –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

| –ö–æ–Ω—Ç–µ–∫—Å—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä—ã |
|----------|------------|---------|
| `SERVER` | –û–±—â–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è | –ó–∞–ø—É—Å–∫, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |
| `DATABASE` | –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –∑–∞–ø—Ä–æ—Å—ã, –æ—à–∏–±–∫–∏ |
| `WEBSOCKET` | WebSocket —Å–æ–±—ã—Ç–∏—è | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è, —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç–∫–ª—é—á–µ–Ω–∏—è |
| `API` | HTTP API –∑–∞–ø—Ä–æ—Å—ã | –ú–∞—Ä—à—Ä—É—Ç—ã, –æ—Ç–≤–µ—Ç—ã, –æ—à–∏–±–∫–∏ |
| `AUTH` | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | –õ–æ–≥–∏–Ω, —Ç–æ–∫–µ–Ω—ã, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |
| `TELEGRAM` | Telegram Bot | –ö–æ–º–∞–Ω–¥—ã, webhook, —Å–æ–æ–±—â–µ–Ω–∏—è |
| `PERFORMANCE` | –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ | –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –ø–∞–º—è—Ç—å |
| `SECURITY` | –°–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ |
| `BUSINESS` | –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ | –°–ª–æ—Ç—ã, –ª–æ—Ç–µ—Ä–µ—è, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ |

## üîß –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

### –°–∫—Ä–∏–ø—Ç –∑–∞–º–µ–Ω—ã console.log:

```bash
# –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ console.log –≤ –ø—Ä–æ–µ–∫—Ç–µ
node scripts/replace-console-logs.js

# –ó–∞–º–µ–Ω–∏—Ç—å –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
node scripts/replace-console-logs.js server/src/controllers
```

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:

1. **–°–∫–∞–Ω–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã** —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏ `.ts`, `.tsx`, `.js`, `.jsx`
2. **–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç** –ø–æ –ø—É—Ç–∏ —Ñ–∞–π–ª–∞
3. **–ó–∞–º–µ–Ω—è–µ—Ç** `console.method()` –Ω–∞ `logger.method(context, ...)`
4. **–î–æ–±–∞–≤–ª—è–µ—Ç –∏–º–ø–æ—Ä—Ç—ã** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
5. **–ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç** —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏–∑

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–æ–≤:

```json
{
  "timestamp": "2024-01-15T10:30:00.000Z",
  "level": "INFO",
  "context": "BUSINESS",
  "message": "Slot purchased successfully",
  "data": {
    "userId": "user123",
    "amount": 100,
    "currency": "USD"
  },
  "requestId": "req_1705312200000_abc123",
  "duration": 45
}
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–æ–≤:

```bash
# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
grep '"level":"ERROR"' logs/app.log

# –¢–æ–ª—å–∫–æ –±–∏–∑–Ω–µ—Å-–æ–ø–µ—Ä–∞—Ü–∏–∏
grep '"context":"BUSINESS"' logs/app.log

# –ü–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
grep '"userId":"user123"' logs/app.log

# –ü–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
grep '"duration":[5-9][0-9][0-9]' logs/app.log
```

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –≠—Ç–∞–ø 1: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω
- [x] –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã middleware
- [x] –û–±–Ω–æ–≤–ª–µ–Ω –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª —Å–µ—Ä–≤–µ—Ä–∞
- [x] –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 2: üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∑–∞–º–µ–Ω—ã console.log
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —É—Ç–∏–ª–∏—Ç—ã
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –≠—Ç–∞–ø 3: üìã –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ (Sentry, LogRocket)
- [ ] –î–∞—à–±–æ—Ä–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- [ ] –ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã** - –≤—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
2. **–î–æ–±–∞–≤–ª—è–π—Ç–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** - –≤–∫–ª—é—á–∞–π—Ç–µ –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
3. **–ò–∑–±–µ–≥–∞–π—Ç–µ console.log** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
4. **–õ–æ–≥–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏** - –≤—Å–µ–≥–¥–∞ –ª–æ–≥–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

### –î–ª—è production:

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É—Ä–æ–≤–Ω–∏** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ INFO –∏–ª–∏ WARN –≤ production
2. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã** - –ø–æ–ª—É—á–∞–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
4. **–ê—Ä—Ö–∏–≤–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏** - —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ª–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

## üîç –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ:

```typescript
import { logger, LogContext } from '../utils/logger.js';

export const purchaseSlot = async (req: Request, res: Response) => {
  const timer = new PerformanceTimer(LogContext.API, 'Purchase slot');
  
  try {
    logger.business('Slot purchase initiated', {
      userId: req.user.id,
      amount: req.body.amount
    });
    
    const result = await slotService.purchase(req.user.id, req.body.amount);
    
    timer.end({ success: true, slotId: result.id });
    
    logger.business('Slot purchase completed', {
      userId: req.user.id,
      slotId: result.id,
      amount: req.body.amount
    });
    
    res.json(result);
  } catch (error) {
    timer.end({ success: false, error: error.message });
    
    logger.error(LogContext.BUSINESS, 'Slot purchase failed', error, {
      userId: req.user.id,
      amount: req.body.amount
    });
    
    res.status(500).json({ error: 'Purchase failed' });
  }
};
```

### –í —Å–µ—Ä–≤–∏—Å–µ:

```typescript
import { logger, LogContext } from '../utils/logger.js';

export class SlotService {
  async purchase(userId: string, amount: number) {
    logger.database('Starting slot purchase transaction', { userId, amount });
    
    const result = await prisma.$transaction(async (tx) => {
      // ... –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
    });
    
    logger.database('Slot purchase transaction completed', {
      userId,
      slotId: result.id,
      amount
    });
    
    return result;
  }
}
```

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–º –∏ —É–¥–æ–±–Ω—ã–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏! üéâ
